{"ast":null,"code":"var _jsxFileName = \"/home/imane/Documents/M1/S2/Projet annuel/frontend/src/pages/ChallengePage.tsx\",\n    _s = $RefreshSig$();\n\n/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useState } from 'react'; // import './CodeRunning.scss';\n\nimport Editor from '@monaco-editor/react';\nimport Axios from '../axios-config';\nimport { useAuthHeader } from 'react-auth-kit';\nimport { Carousel } from '../components/challenges/Carousel';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const ChallengePage = props => {\n  _s();\n\n  const [challenge, setChallenge] = useState({});\n  const [code, setCode] = useState('');\n  const [stdout, setStdout] = useState('STDOUT');\n  const authHeader = useAuthHeader();\n  useEffect(() => {\n    const fetchChallenge = async id => {\n      const {\n        data: {\n          content\n        }\n      } = await Axios.get(`/challenges/${id}`, {\n        headers: {\n          Authorization: authHeader()\n        }\n      });\n      setChallenge(content);\n    };\n\n    fetchChallenge(props.match.params.id);\n  }, [props.match.params.id]);\n  useEffect(() => {\n    var _challenge$execBootst, _challenge$execBootst2;\n\n    const placeholder = challenge === null || challenge === void 0 ? void 0 : (_challenge$execBootst = challenge.execBootstraps) === null || _challenge$execBootst === void 0 ? void 0 : (_challenge$execBootst2 = _challenge$execBootst.find(eb => eb.language === props.match.params.language)) === null || _challenge$execBootst2 === void 0 ? void 0 : _challenge$execBootst2.functionTemplate;\n\n    if (placeholder) {\n      // setCodePlaceholder(placeholder);\n      setCode(placeholder);\n    }\n  }, [challenge]);\n\n  const runOnClick = () => {\n    const toastId = toast.loading('Running code...');\n    Axios.post(`/attempts`, {\n      challenge: challenge._id.split('/').pop(),\n      code,\n      language: props.match.params.language\n    }, {\n      headers: {\n        Authorization: authHeader()\n      }\n    }).then(({\n      data\n    }) => {\n      console.log(data);\n      toast.success(`Successfully ran the code.`, {\n        id: toastId\n      });\n\n      if (data.content.stdout === '') {\n        setStdout(data.content.stderr);\n      } else {\n        setStdout(data.content.stdout);\n      }\n    }).catch(err => {\n      if (err.isAxiosError) {\n        var _err$response;\n\n        toast.error(`An error occured: ${(_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data.message}`, {\n          id: toastId\n        });\n      } else {\n        toast.error(`An unknown error occured: ${err}`, {\n          id: toastId\n        });\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen py-6 flex flex-col justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4 rounded m-5 p-10\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-600 rounded m-15 p-10 col-span-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-bold text-xl mb-2 flex flex-row\",\n            children: [challenge.name, /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-blue-500 py-1 px-2 rounded-full text-sm w-min ml-2\",\n              children: props.match.params.language\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: challenge.instructions\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rounded-lg h-full overflow-hidden flex flex-col justify-center items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative max-h-full w-full\",\n            children: [/*#__PURE__*/_jsxDEV(Editor, {\n              language: props.match.params.language,\n              defaultLanguage: props.match.params.language,\n              height: \"80vh\",\n              onChange: value => {\n                setCode(value);\n              },\n              value: code,\n              theme: \"vs-dark\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"absolute top-0 right-0 bg-blue-500 px-2 rounded-bl-lg h-10 w-20 \",\n              onClick: runOnClick,\n              children: \"Run\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-auto w-full overflow-hidden rounded-b\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-black max-h-full h-full p-2 w-full text-left font-light\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"whitespace-pre\",\n                children: stdout || \"Aucune sortie après l'execution de ce code.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Carousel, {\n          picturesUrls: challenge.pictures\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(ChallengePage, \"I8ZkEaQS357NWZYqGEDPTVIcwhY=\", false, function () {\n  return [useAuthHeader];\n});\n\n_c = ChallengePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChallengePage\");","map":{"version":3,"sources":["/home/imane/Documents/M1/S2/Projet annuel/frontend/src/pages/ChallengePage.tsx"],"names":["React","useEffect","useState","Editor","Axios","useAuthHeader","Carousel","toast","ChallengePage","props","challenge","setChallenge","code","setCode","stdout","setStdout","authHeader","fetchChallenge","id","data","content","get","headers","Authorization","match","params","placeholder","execBootstraps","find","eb","language","functionTemplate","runOnClick","toastId","loading","post","_id","split","pop","then","console","log","success","stderr","catch","err","isAxiosError","error","response","message","name","instructions","value","pictures"],"mappings":"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","sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useState } from 'react';\n// import './CodeRunning.scss';\n\nimport Editor from '@monaco-editor/react';\nimport Axios from '../axios-config';\nimport { useAuthHeader } from 'react-auth-kit';\nimport { Carousel } from '../components/challenges/Carousel';\nimport toast from 'react-hot-toast';\n\ntype Challenge = {\n  _id: string;\n  name: string;\n  instructions: string;\n  pictures: { file: string }[];\n  execBootstraps: { functionTemplate: string; language: string }[];\n};\n\nexport const ChallengePage = (props: {\n  match: { params: { id: string; language: string } };\n}) => {\n  const [challenge, setChallenge] = useState({} as Challenge);\n  const [code, setCode] = useState('');\n\n  const [stdout, setStdout] = useState('STDOUT');\n\n  const authHeader = useAuthHeader();\n\n  useEffect(() => {\n    const fetchChallenge = async (id: string) => {\n      const {\n        data: { content },\n      } = await Axios.get(`/challenges/${id}`, {\n        headers: { Authorization: authHeader() },\n      });\n      setChallenge(content);\n    };\n\n    fetchChallenge(props.match.params.id);\n  }, [props.match.params.id]);\n\n  useEffect(() => {\n    const placeholder = challenge?.execBootstraps?.find(\n      (eb) => eb.language === props.match.params.language,\n    )?.functionTemplate;\n\n    if (placeholder) {\n      // setCodePlaceholder(placeholder);\n      setCode(placeholder);\n    }\n  }, [challenge]);\n\n  const runOnClick = () => {\n    const toastId = toast.loading('Running code...');\n\n    Axios.post(\n      `/attempts`,\n      {\n        challenge: challenge._id.split('/').pop(),\n        code,\n        language: props.match.params.language,\n      },\n      {\n        headers: {\n          Authorization: authHeader(),\n        },\n      },\n    )\n      .then(({ data }) => {\n        console.log(data);\n        toast.success(`Successfully ran the code.`, {\n          id: toastId,\n        });\n\n        if (data.content.stdout === '') {\n          setStdout(data.content.stderr);\n        } else {\n          setStdout(data.content.stdout);\n        }\n      })\n      .catch((err) => {\n        if (err.isAxiosError) {\n          toast.error(`An error occured: ${err.response?.data.message}`, {\n            id: toastId,\n          });\n        } else {\n          toast.error(`An unknown error occured: ${err}`, { id: toastId });\n        }\n      });\n  };\n\n  return (\n    <>\n      <div className=\"min-h-screen py-6 flex flex-col justify-center\">\n        <div className=\"grid grid-cols-2 gap-4 rounded m-5 p-10\">\n          <div className=\"bg-gray-600 rounded m-15 p-10 col-span-2\">\n            <div className=\"font-bold text-xl mb-2 flex flex-row\">\n              {challenge.name}\n              <div className=\"bg-blue-500 py-1 px-2 rounded-full text-sm w-min ml-2\">\n                {props.match.params.language}\n              </div>\n            </div>\n            <p>{challenge.instructions}</p>\n          </div>\n          <div className=\"rounded-lg h-full overflow-hidden flex flex-col justify-center items-center\">\n            <div className=\"relative max-h-full w-full\">\n              <Editor\n                language={props.match.params.language}\n                defaultLanguage={props.match.params.language}\n                height=\"80vh\"\n                onChange={(value) => {\n                  setCode(value as string);\n                }}\n                value={code}\n                theme=\"vs-dark\"\n              />\n\n              <button\n                className=\"absolute top-0 right-0 bg-blue-500 px-2 rounded-bl-lg h-10 w-20 \"\n                onClick={runOnClick}\n              >\n                Run\n              </button>\n            </div>\n            <div className=\"h-auto w-full overflow-hidden rounded-b\">\n              <div className=\"bg-black max-h-full h-full p-2 w-full text-left font-light\">\n                <span className=\"whitespace-pre\">\n                  {stdout || \"Aucune sortie après l'execution de ce code.\"}\n                </span>\n              </div>\n            </div>\n          </div>\n          <Carousel picturesUrls={challenge.pictures} />\n        </div>\n      </div>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}